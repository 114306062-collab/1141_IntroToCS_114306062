<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>1A2B Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 40px;
        }
        #record {
            margin-top: 20px;
            width: 60%;
            margin-left: auto;
            margin-right: auto;
            text-align: left;
            border: 1px solid #aaa;
            padding: 10px;
            min-height: 150px;
        }
        input {
            padding: 8px;
            width: 150px;
        }
        button {
            padding: 8px 16px;
            margin-left: 8px;
        }
    </style>
</head>
<body>

<h1>StudentID_HW6_1A2B</h1>

<input id="guessInput" type="text" placeholder="Enter 4 digits">
<button onclick="play()">Guess</button>

<div id="record">
    <h3>Record:</h3>
</div>

<script>
// 生成不重複的 4 位數答案

function generateAnswer() {
    let digits = [0,1,2,3,4,5,6,7,8,9];
    let ans = [];

    while (ans.length < 4) {
        let idx = Math.floor(Math.random() * digits.length);
        ans.push(digits[idx]);
        digits.splice(idx, 1); // Remove chosen digit
    }

    return ans.join("");
}

let answer = generateAnswer();
let attempts = 0;

// 驗證玩家輸入是否合法
function isValid(str) {
    if (str.length !== 4) return false;
    if (!/^\d{4}$/.test(str)) return false;

    // Check unique digits
    let set = new Set(str);
    return set.size === 4;
}


// 計算 A/B

function checkAB(guess, ans) {
    let A = 0, B = 0;

    let gArr = guess.split("");
    let aArr = ans.split("");

    for (let i = 0; i < 4; i++) {
        if (gArr[i] === aArr[i]) {
            A++;
        } else if (aArr.includes(gArr[i])) {
            B++;
        }
    }

    return `${A}A${B}B`;
}


// 主遊戲流程

function play() {
    let inputField = document.getElementById("guessInput");
    let guess = inputField.value.trim();

    // 驗證輸入
    if (!isValid(guess)) {
        alert("Invalid input! Please enter 4 UNIQUE digits.");
        inputField.value = "";
        return;
    }

    attempts++;
    let result = checkAB(guess, answer);

    // 更新紀錄區
    let record = document.getElementById("record");
    record.innerHTML += `<p>${guess} → ${result}</p>`;

    // 猜中！
    if (result === "4A0B") {
        alert(`Correct! You guessed it in ${attempts} attempts!`);
    }

    inputField.value = "";
}
</script>

</body>
</html>
